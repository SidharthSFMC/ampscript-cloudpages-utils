<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Unsubscribe</title>
        <style>
            body { font-family: Arial, sans-serif; background-color: #ecf0f3; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; } .container { max-width: 400px; background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.1); text-align: center; } h1 { color: #333; } p { color: #666; margin-top: 20px; } form { margin-top: 20px; } button { padding: 10px 20px; background-color: #3498db; color: #fff; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.3s ease; } button:hover { background-color: #2980b9; } .success-message { color: #27ae60; margin-top: 20px; } .logo { max-width: 150px; margin-bottom: 20px; }
        </style>
      %%[
    /*One button Click Unsubscribe */
    SET @subscriberKey = "Test_11"
    SET @submitted = IIF(RequestParameter("Submitted") == "True", "True", "False")
    SET @display = "none"
    IF @submitted == "True" THEN
        SET @status = "Active"
        set @BU_MID= AuthenticatedMemberID()
        
        /*Create a Subscriber Object */
        SET @subscriber = CreateObject("Subscriber")
        SetObjectProperty(@subscriber, "Status", @status)
        SetObjectProperty(@subscriber, "SubscriberKey", @subscriberKey)
        
        /*Create a ClientId Object */
        SET @clientObject = CreateObject("ClientID")
        SetObjectProperty(@clientObject, "ID", @BU_MID)
        SetObjectProperty(@clientObject, "IDSpecified", "true")
        SetObjectProperty(@subscriber, "Client", @clientObject)
        
        /*Create Update and Save Objects with parameters */
        SET @updateOptions = CreateObject("UpdateOptions")
        SET @saveOptions = CreateObject("SaveOption")
        
        SetObjectProperty(@saveOptions, "SaveAction", "UpdateAdd")
        SetObjectProperty(@saveOptions, "PropertyName", "*")
        AddObjectArrayItem(@updateOptions, "SaveOptions", @saveOptions)
        
        SET @subscriberStatus = InvokeUpdate(@subscriber, @update_sub_status, @update_sub_errorcode, @updateOptions)
        SET @display = ""
 ENDIF
]%%
  
</head>
<body>
  <div class="container">
    <img src="https://www.salesforce.com/news/wp-content/uploads/sites/3/2021/05/Salesforce-logo.jpg" alt="Your Logo" class="logo">
    <h1>Unsubscribe</h1>
    <p>Click the button below to unsubscribe from our newsletter.</p>
    <form id="unsubscribeForm" method="post" action="%%=RequestParameter('PAGEURL')=%%">
        <input type="hidden" name="SubscriberKey" id="SubscriberKey" value="%%=v(@subscriberKey)=%%">
        <input type="hidden" name="Submitted" id="Submitted" value="True">
      <button type="submit">Unsubscribe</button>
    </form>
    <div style="display:%%=v(@display)=%%">
       <p class="success-message" id="successMessage" >You have been successfully unsubscribed.</p>
    </div>
   
  </div>
</body>
</html>
